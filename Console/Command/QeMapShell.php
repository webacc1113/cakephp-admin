<?php
App::import('Lib', 'Utilities');

class QeMapShell extends AppShell {

	var $uses = array('Setting');

	// Behaviors:
	// 'equivalent': answers and answer count are identical
	// 'superset': lucid has more answers, but all p2s options can still be mapped
	public $lucid_to_p2s = array(
		'gender' => array(
			'lucid' => '43',
			'p2s' => '597',
			'precodes' => array(
				'1' => '10682',
				'2' => '10683'
			),
			'behavior' => 'equivalent'
		),
		'hispanic' => array(
			'lucid' => '47',
			'p2s' => '571',
			'precodes' => array(
				'1' => '6729',
				'2' => '6730',
				'3' => '6898',
				'4' => '6900',
				'5' => '6901',
				'6' => '6902',
				'7' => '6903',
				'8' => '6904',
				'9' => '6905',
				'10' => '6906',
				'11' => '6907',
				'12' => '6908',
				'13' => '6909',
				'14' => '6910'
			),
			'behavior' => 'equivalent'
		),
		'hhi_us1' => array(
			'lucid' => '48740',
			'p2s' => '590',
			'precodes' => array(
				'1' => '9089',
				'2' => '9071',
				'3' => '9072',
				'4' => '9088',
				'5' => '9073',
				'6' => '9087',
				'7' => '9074',
				'8' => '9086',
				'9' => '9090',
				'10' => '9075',
				'11' => '9091',
				'12' => '9076',
				'13' => '9092',
				'14' => '9077',
				'15' => '9093',
				'16' => '9078',
				'17' => '9094',
				'18' => '9079',
				'19' => '9080',
				'20' => '9081',
				'21' => '9082',
				'22' => '9085',
				'23' => '9084',
				'24' => '9084'
			),
			'behavior' => 'superset'
		),
		'hhi_us2' => array(
			'lucid' => '48740',
			'p2s' => '590',
			'precodes' => array(
				'1' => '3674544',
				'2' => '3674527',
				'3' => '3674528',
				'4' => '3674543',
				'5' => '3674529',
				'6' => '3674542',
				'7' => '3674530',
				'8' => '3674541',
				'9' => '3674545',
				'10' => '3674531',
				'11' => '3674546',
				'12' => '3674532',
				'13' => '3674547',
				'14' => '3674533',
				'15' => '3674548',
				'16' => '3674534',
				'17' => '3674549',
				'18' => '3674535',
				'19' => '3674536',
				'20' => '3674537',
				'21' => '3674538',
				'22' => '3674540',
				'23' => '3674539',
				'24' => '3674539',
			),
			'behavior' => 'superset'
		),
		'state' => array(
			'lucid' => '96',
			'p2s' => '2399',
			'precodes' => array(
				'1' => '31391',
				'2' => '31392',
				'3' => '31393',
				'4' => '31394',
				'5' => '31395',
				'6' => '31396',
				'7' => '31397',
				'8' => '31398',
				'9' => '31438',
				'10' => '31399',
				'11' => '31400',
				'12' => '31401',
				'13' => '31402',
				'14' => '31403',
				'15' => '31404',
				'16' => '31405',
				'17' => '31406',
				'18' => '31407',
				'19' => '31408',
				'20' => '31409',
				'21' => '31410',
				'22' => '31411',
				'23' => '31412',
				'24' => '31413',
				'25' => '31414',
				'26' => '31415',
				'27' => '31416',
				'28' => '31417',
				'29' => '31418',
				'30' => '31419',
				'31' => '31420',
				'32' => '31421',
				'33' => '31422',
				'34' => '31423',
				'35' => '31424',
				'36' => '31425',
				'37' => '31426',
				'38' => '31427',
				'39' => '31428',
				'40' => '31429',
				'41' => '31430',
				'42' => '31431',
				'43' => '31432',
				'44' => '31433',
				'45' => '31434',
				'46' => '31435',
				'47' => '31436',
				'48' => '31437',
				'49' => '31439',
				'50' => '31440',
				'51' => '31441'
			),
			'behavior' => 'superset'
		),
		'region' => array(
			'lucid' => '122',
			'p2s' => '605',
			'precodes' => array(
				'1' => '26837',
				'2' => '26838',
				'3' => '26839',
				'4' => '26840'
			),
			'behavior' => 'equivalent'
		),
		'org_size' => array(
			'lucid' => '22467',
			'p2s' => '510',
			'precodes' => array(
				'1' => '19990',
				'2' => '6069',
				'3' => '6070',
				'4' => '6071',
				'5' => '6072',
				'6' => '6073',
				'7' => '6074',
				'8' => '6075',
				'9' => '6076'
			),
			'behavior' => 'equivalent'
		),
		'org_role' => array(
			'lucid' => '15297',
			'p2s' => '607',
			'precodes' => array(
				'1' => '14899',
				'2' => '14900',
				'3' => '14901',
				'4' => '14902',
				'5' => '14903',
				'6' => '14904',
				'7' => '14905',
				'8' => '14906',
				'9' => '14907',
				'10' => '14908',
				'11' => '14909'
			),
			'behavior' => 'equivalent'
		),
		'pregnant' => array(
			'lucid' => '7064',
			'p2s' => '569',
			'precodes' => array(
				'1' => '6887',
				'2' => '6888',
				'3' => '6889',
				'4' => '6890'
			),
			'behavior' => 'equivalent'
		),
		'org_rev' => array(
			'lucid' => '645',
			'p2s' => '509',
			'precodes' => array(
				'1' => '6055',
				'2' => '6056',
				'3' => '6057',
				'4' => '6058',
				'5' => '6059',
				'6' => '6060',
				'7' => '6061',
				'8' => '6062',
				'9' => '6063',
				'10' => '6064',
				'11' => '6065',
				'12' => '6066',
				'13' => '6067',
				'14' => '6068'
			),
			'behavior' => 'equivalent'
		),
		'household_lang' => array(
			'lucid' => '32352',
			'p2s' => '619',
			'precodes' => array(
				'1' => '14971',
				'2' => '14970',
				'3' => '14969',
				'4' => '14968',
				'5' => '14967'
			),
			'behavior' => 'equivalent'
		),
		'household_purchasing' => array(
			'lucid' => '638',
			'p2s' => '533',
			'precodes' => array(
				'1' => '6364',
				'2' => '6365',
				'3' => '6366'
			),
			'behavior' => 'equivalent'
		),
		'household' => array(
			'lucid' => '642',
			'p2s' => '508',
			'precodes' => array(
				'1' => '6047',
				'2' => '6048',
				'3' => '6049',
				'4' => '6050',
				'5' => '6051',
				'6' => '6052',
				'7' => '6053',
				'8' => '6054'
			),
			'behavior' => 'equivalent'
		),
		'pets' => array(
			'lucid' => '639',
			'p2s' => '534',
			'precodes' => array(
				'1' => '6367',
				'2' => '6368',
				'3' => '6369',
				'4' => '6370',
				'5' => '6371',
				'6' => '6372',
				'7' => '6373',
				'8' => '6374',
				'9' => '6375',
				'10' => '6376',
				'-3105' => '6377'
			),
			'behavior' => 'equivalent'
		),
		'smart_phone' => array(
			'lucid' => '737',
			'p2s' => '496',
			'precodes' => array(
				'1' => '5887',
				'2' => '5888',
				'3' => '5889',
				'4' => '5890'
			),
			'behavior' => 'equivalent'
		),
		'drive' => array(
			'lucid' => '647',
			'p2s' => '511',
			'precodes' => array(
				'1' => '6077',
				'2' => '6078',
				'3' => '6079',
				'4' => '6080'
			),
			'behavior' => 'equivalent'
		),
		'webcam1' => array(
			'lucid' => '43501',
			'p2s' => '1005',
			'precodes' => array(
				'1' => '17798',
				'2' => '17799',
				'3' => '17799'
			),
			'behavior' => 'superset'
		),
		'travel_plane' => array(
			'lucid' => '750',
			'p2s' => '528',
			'precodes' => array(
				'1' => '6331',
				'2' => '6332',
				'3' => '6333',
				'4' => '6334'
			),
			'behavior' => 'equivalent'
		),
		'division' => array(
			'lucid' => '101',
			'p2s' => '688',
			'precodes' => array(
				'1' => '3658977',
				'2' => '3658975',
				'3' => '3658973',
				'4' => '3658980',
				'5' => '3658979',
				'6' => '3658974',
				'7' => '3658981',
				'8' => '3658976',
				'9' => '3658978'
			),
			'behavior' => 'equivalent'
		),
		'games' => array(
			'lucid' => '744',
			'p2s' => '552',
			'precodes' => array(
				'1' => '6670',
				'2' => '6671',
				'3' => '6672',
				'4' => '6673',
				'5' => '6674',
				'6' => '6675'
			),
			'behavior' => 'equivalent'
		),
		'smoke' => array(
			'lucid' => '756',
			'p2s' => '530',
			'precodes' => array(
				'1' => '6341',
				'2' => '6342',
				'3' => '6343',
				'4' => '6344',
				'5' => '6345'
			),
			'behavior' => 'equivalent'
		),
		'voter_registration' => array(
			'lucid' => '634',
			'p2s' => '560',
			'precodes' => array(
				'1' => '6912',
				'2' => '6913'
			),
			'behavior' => 'equivalent'
		),
		'tv' => array(
			'lucid' => '747',
			'p2s' => '555',
			'precodes' => array(
				'1' => '6685',
				'2' => '6686',
				'3' => '6687',
				'4' => '6688',
				'5' => '6689'
			),
			'behavior' => 'equivalent'
		),
		'car_purchases' => array(
			'lucid' => '648',
			'p2s' => '514',
			'precodes' => array(
				'1' => '6139',
				'2' => '6140',
				'3' => '6141'
			),
			'behavior' => 'equivalent'
		),
		'drivers_license' => array(
			'lucid' => '28975',
			'p2s' => '779',
			'precodes' => array(
				'1' => '16175',
				'2' => '16176'
			),
			'behavior' => 'equivalent'
		),
		'car_new_or_used' => array(
			'lucid' => '717',
			'p2s' => '499',
			'precodes' => array(
				'1' => '5899',
				'2' => '5900',
				'3' => '5901'
			),
			'behavior' => 'equivalent'
		),
		'gaming_per_week' => array(
			'lucid' => '742',
			'p2s' => '550',
			'precodes' => array(
				'1' => '6658',
				'2' => '6659',
				'3' => '6660',
				'4' => '6661',
				'5' => '6662',
				'6' => '6663',
				'7' => '6664',
				'8' => '6665'
			),
			'behavior' => 'equivalent'
		),
		'car_manufactured_year' => array(
			'lucid' => '715',
			'p2s' => '501',
			'precodes' => array(
				'1' => '5923',
				'3' => '5924',
				'4' => '5925',
				'5' => '5926',
				'6' => '5927',
				'7' => '5928',
				'8' => '5929',
				'9' => '5930',
				'10' => '5931',
				'11' => '5932',
				'12' => '5933',
				'13' => '5934',
				'14' => '5935',
				'15' => '5936',
				'16' => '5937',
				'17' => '5938',
				'18' => '5939',
				'19' => '5940',
				'20' => '5941',
				'21' => '5942',
				'22' => '15761',
				'23' => '5943',
				'24' => '731571',
				'25' => '731572',
				'26' => '3667182'
			),
			'behavior' => 'equivalent'
		),
		'people_in_household' => array(
			'lucid' => '641',
			'p2s' => '505',
			'precodes' => array(
				'1' => '5984',
				'2' => '5985',
				'3' => '5986',
				'4' => '5987',
				'5' => '5988',
				'6' => '5989',
				'7' => '5990'
			),
			'behavior' => 'equivalent'
		),
		'glasses' => array(
			'lucid' => '769',
			'p2s' => '486',
			'precodes' => array(
				'1' => '5649',
				'2' => '5650',
				'3' => '5651',
				'4' => '5652',
				'5' => '5653'
			),
			'behavior' => 'equivalent'
		),
		'alcohol' => array(
			'lucid' => '724',
			'p2s' => '540',
			'precodes' => array(
				'1' => '6479',
				'2' => '6480',
				'3' => '6481',
				'4' => '6482',
				'5' => '6483'
			),
			'behavior' => 'equivalent'
		),
		'webcam2' => array(
			'lucid' => '43501',
			'p2s' => '3871',
			'precodes' => array(
				'1' => '3658887',
				'2' => '3658888',
				'3' => '3658889'
			),
			'behavior' => 'equivalent'
		),
		'radio' => array(
			'lucid' => '748',
			'p2s' => '556',
			'precodes' => array(
				'1' => '6690',
				'2' => '6691',
				'3' => '6692',
				'4' => '6693',
				'5' => '6694'
			),
			'behavior' => 'equivalent'
		),
		'fast_food' => array(
			'lucid' => '720',
			'p2s' => '544',
			'precodes' => array(
				'1' => '6547',
				'2' => '6548',
				'3' => '6549',
				'4' => '6550',
				'5' => '6551',
				'6' => '6552'
			),
			'behavior' => 'equivalent'
		),
		'gambling' => array(
			'lucid' => '732',
			'p2s' => '518',
			'precodes' => array(
				'1' => '6206',
				'2' => '6207',
				'3' => '6208',
				'4' => '6209',
				'5' => '6210',
				'6' => '6211',
				'7' => '6212',
				'8' => '6213',
				'9' => '6214',
				'10' => '6215',
				'11' => '6216',
				'12' => '6217'
			),
			'behavior' => 'equivalent'
		),
		'ethnicity_ca' => array(
			'lucid' => '32353',
			'p2s' => '3062',
			'precodes' => array(
				'1' => '3651514',
				'2' => '3651515',
				'3' => '3651516',
				'4' => '3651517',
				'5' => '3651518',
				'6' => '3651519',
				'7' => '3651520',
				'8' => '3651521',
				'9' => '3651522',
				'10' => '3651523',
				'11' => '3651524'
			),
			'behavior' => 'equivalent'
		)
	);

	public $lucid_to_lucid = array(
		'hhi' => array(
			'v1' => '14785',
			'v2' => '48740',
			'precodes' => array(
				"1" => "1",
				"2" => "1",
				"3" => "1",
				"4" => "2",
				"5" => "3",
				"6" => "4",
				"7" => "5",
				"8" => "6",
				"9" => "7",
				"10" => "8",
				"11" => "9",
				"12" => "10",
				"13" => "11",
				"14" => "12",
				"15" => "13",
				"16" => "14",
				"17" => "15",
				"18" => "16",
				"19" => "17",
				"20" => "18",
				"21" => "19",
				"22" => "20",
				"23" => "21",
				"24" => "22",
				"25" => "23",
				"26" => "24",
				"27" => "25"
			),
			'behavior' => 'superset'
		),
		'education' => array(
			'v1' => '633',
			'v2' => '48741',
			'precodes' => array(
				"1" => "1",
				"2" => "1",
				"3" => "1",
				"4" => "2",
				"5" => "3",
				"6" => "4",
				"7" => "5",
				"8" => "6",
				"9" => "6",
				"10" => "7",
				"11" => "8",
				"12" => "-3105"
			),
			'behavior' => 'superset'
		),
		'gaming' => array(
			'v1' => '740',
			'v2' => '32322',
			'precodes' => array(
				"1" => "1",
				"2" => "2",
				"3" => "3",
				"4" => "4",
				"5" => "5",
				"6" => "7",
				"7" => "8",
				"8" => "9",
				"9" => "10",
				"10" => "11",
				"11" => "12",
				"12" => "13",
				"13" => "14",
				"14" => "16",
				"15" => "17",
				"16" => "18",
				"17" => "19",
				"18" => "21",
				"22" => "4",
				"23" => "20",
				"21" => "24"
			),
			'behavior' => 'superset'
		),
		'hhi_us' => array(
			'v1' => '48740',
			'v2' => '61076',
			'precodes' => array(
				"1" => "1",
				"2" => "2",
				"3" => "3",
				"4" => "4",
				"5" => "5",
				"6" => "6",
				"7" => "7",
				"8" => "8",
				"9" => "9",
				"10" => "10",
				"11" => "11",
				"12" => "12",
				"13" => "13",
				"14" => "14",
				"15" => "15",
				"16" => "16",
				"17" => "17",
				"18" => "18",
				"19" => "19",
				"20" => "20",
				"21" => "21",
				"22" => "22",
				"23" => "23",
				"24" => "24",
				"25" => "-3105"
			),
			'behavior' => 'equivalent'
		)
	);
	
	public $lucid_to_cint = array(
		'ethnicity_gb' => array(
			'lucid' => '34430',
			'cint' => '369598',
			'precodes' => array(
				'1' => '8268358',
				'2' => '8268363',
				'3' => '8268360',
				'4' => '8268360',
				'5' => '8268360',
				'6' => '8268362',
				'7' => '8268360',
				'8' => '8268361',
				'9' => '8268359',
				'10' => '8268363',
			),
			'behavior' => 'superset'
		),
		'ethnicity_us' => array(
			'lucid' => '113',
			'cint' => '274997',
			'precodes' => array(
				'1' => '4709383',
				'2' => '4709380',
				'3' => '4709378',
				'4' => '4709379',
				'5' => '4709379',
				'6' => '4709379',
				'7' => '4709379',
				'8' => '4709379',
				'9' => '4709379',
				'10' => '4709379',
				'11' => '4709382',
				'12' => '4709382',
				'13' => '4709382',
				'14' => '4709382',
				'15' => '4709384',
				'16' => '4709385',
			),
			'behavior' => 'superset'
		),
		'hispanic' => array(
			'lucid' => '47',
			'cint' => '274997',
			'precodes' => array(
				'2' => '4709381',
				'3' => '4709381',
				'4' => '4709381',
				'5' => '4709381',
				'6' => '4709381',
				'7' => '4709381',
				'8' => '4709381',
				'9' => '4709381',
				'10' => '4709381',
				'11' => '4709381',
				'12' => '4709381',
				'13' => '4709381',
				'14' => '4709381',
				'15' => '4709385',
			),
			'behavior' => 'superset'
		),
		'education_us' => array(
			'lucid' => '633',
			'cint' => '277416',
			'precodes' => array(
				'1' => '4790416',
				'2' => '4790416',
				'3' => '4790417',
				'4' => '4790417',
				'5' => '4790417',
				'6' => '4790418',
				'7' => '4790418',
				'8' => '4790418',
				'9' => '4790419',
				'10' => '4790419',
				'11' => '4790419',
				'12' => '4790420',
			),
			'behavior' => 'superset'
		),
		'education_ca' => array(
			'lucid' => '633',
			'cint' => '369499',
			'precodes' => array(
				'1' => '8265514',
				'2' => '8265514',
				'3' => '8265515',
				'4' => '8265515',
				'5' => '8265515',
				'6' => '8265516',
				'7' => '8265517',
				'8' => '8265517',
				'9' => '8265518',
				'10' => '8265518',
				'11' => '8265518',
				'12' => '8265519',
			),
			'behavior' => 'superset'
		),
		'education_gb' => array(
			'lucid' => '633',
			'cint' => '369619',
			'precodes' => array(
				'1' => '8269950',
				'2' => '8269950',
				'3' => '8269951',
				'4' => '8269951',
				'5' => '8269952',
				'6' => '8269952',
				'7' => '8269953',
				'8' => '8269953',
				'9' => '8269954',
				'10' => '8269954',
				'11' => '8269954',
				'12' => '8269955',
			),
			'behavior' => 'superset'
		),
		'relationship_us' => array(
			'lucid' => '632',
			'cint' => '274999',
			'precodes' => array(
				'1' => '4709393',
				'2' => '4709395',
				'3' => '4709396',
				'4' => '4709394',
				'5' => '4709399',
			),
			'behavior' => 'superset'
		),
		'relationship_ca' => array(
			'lucid' => '632',
			'cint' => '369488',
			'precodes' => array(
				'1' => '8264977',
				'2' => '8264979',
				'3' => '8264980',
				'4' => '8264978',
				'5' => '8264983',
			),
			'behavior' => 'superset'
		),
		'relationship_gb' => array(
			'lucid' => '632',
			'cint' => '369600',
			'precodes' => array(
				'1' => '8268372',
				'2' => '8268374',
				'3' => '8268375',
				'4' => '8268373',
				'5' => '8268378',
			),
			'behavior' => 'superset'
		),
		'purchasing_auto_us' => array(
			'lucid' => '638',
			'cint' => '369600',
			'precodes' => array(
				'1' => '4710176',
				'2' => '4710178',
				'3' => '4710177',
			),
			'behavior' => 'superset'
		),
		'purchasing_auto_ca' => array(
			'lucid' => '638',
			'cint' => '369519',
			'precodes' => array(
				'1' => '8266156',
				'2' => '8266158',
				'3' => '8266157',
			),
			'behavior' => 'superset'
		),
		'purchasing_auto_gb' => array(
			'lucid' => '638',
			'cint' => '369640',
			'precodes' => array(
				'1' => '8270604',
				'2' => '8270606',
				'3' => '8270605',
			),
			'behavior' => 'superset'
		),
		'purchasing_electric_us' => array(
			'lucid' => '638',
			'cint' => '275053',
			'precodes' => array(
				'1' => '4710925',
				'2' => '4710927',
				'3' => '4710926',
			),
			'behavior' => 'superset'
		),
		'purchasing_electric_ca' => array(
			'lucid' => '638',
			'cint' => '369543',
			'precodes' => array(
				'1' => '8266822',
				'2' => '8266824',
				'3' => '8266823',
			),
			'behavior' => 'superset'
		),
		'purchasing_electric_gb' => array(
			'lucid' => '638',
			'cint' => '369666',
			'precodes' => array(
				'1' => '8271418',
				'2' => '8271420',
				'3' => '8271419',
			),
			'behavior' => 'superset'
		),
		'hhi_us' => array(
			'lucid' => '14785',
			'cint' => '275006',
			'precodes' => array(
				'1' => '4792272',
				'2' => '4792272',
				'3' => '4792272',
				'4' => '4792368',
				'5' => '4792368',
				'6' => '4792490',
				'7' => '4792490',
				'8' => '4792490',
				'9' => '4792490',
				'10' => '4792490',
				'11' => '4792599',
				'12' => '4792599',
				'13' => '4792599',
				'14' => '4792599',
				'15' => '4792599',
				'16' => '4792599',
				'17' => '4792722',
				'18' => '4792722',
				'19' => '4792722',
				'20' => '4792722',
				'21' => '4792807',
				'22' => '4792807',
				'23' => '4792921',
				'24' => '4792921',
				'25' => '4793024',
				'26' => '4793024',
				'27' => '4709544',
			),
			'behavior' => 'superset'
		),
		'hhi_ca' => array(
			'lucid' => '14887',
			'cint' => '369495',
			'precodes' => array(
				'1' => '8265300',
				'2' => '8265301',
				'3' => '8265301',
				'4' => '8265302',
				'5' => '8265302',
				'6' => '8265302',
				'7' => '8265302',
				'8' => '8265302',
				'9' => '8265303',
				'10' => '8265303',
				'11' => '8265303',
				'12' => '8265304',
				'13' => '8265305',
				'14' => '8265305',
				'15' => '8265306',
				'16' => '8265306',
				'17' => '8265307',
				'18' => '8265481',
			),
			'behavior' => 'superset'
		),
		'hhi_gb' => array(
			'lucid' => '14785',
			'cint' => '369607',
			'precodes' => array(
				'1' => '8268735',
				'2' => '8268737',
				'3' => '8268737',
				'4' => '8268737',
				'5' => '8268737',
				'6' => '8268738',
				'7' => '8268738',
				'8' => '8268738',
				'9' => '8268738',
				'10' => '8268739',
				'11' => '8268740',
				'12' => '8268740',
				'13' => '8268741',
				'14' => '8268741',
				'15' => '8268742',
				'16' => '8268742',
				'17' => '8268742',
				'18' => '8268876',
			),
			'behavior' => 'superset'
		),
		'smoke_us' => array(
			'lucid' => '756',
			'cint' => '275081',
			'precodes' => array(
				'1' => '4711864',
				'2' => '4711865',
				'3' => '4711866',
				'4' => '4711868',
				'5' => '4711869',
			),
			'behavior' => 'superset'
		),
		'smoke_ca' => array(
			'lucid' => '756',
			'cint' => '369570',
			'precodes' => array(
				'1' => '8267783',
				'2' => '8267784',
				'3' => '8267785',
				'4' => '8267787',
				'5' => '8267788',
			),
			'behavior' => 'superset'
		),
		'smoke_gb' => array(
			'lucid' => '756',
			'cint' => '369697',
			'precodes' => array(
				'1' => '8272433',
				'2' => '8272434',
				'3' => '8272435',
				'4' => '8272437',
				'5' => '8272438',
			),
			'behavior' => 'superset'
		),
		'illness_us' => array(
			'lucid' => '759',
			'cint' => '275086',
			'precodes' => array(
				'1' => '4712066',
				'2' => '4712067',
				'3' => '4712068',
				'4' => '4712069',
				'5' => '4712070',
				'6' => '4712071',
				'7' => '4712072',
				'8' => '4712073',
				'9' => '4712074',
				'10' => '4712075',
				'11' => '4712077',
				'12' => '4712078',
				'13' => '4712079',
				'14' => '4712080',
				'15' => '4712081',
				'16' => '4712082',
				'17' => '4712084',
				'18' => '4712085',
				'19' => '4712086',
				'20' => '4712090',
				'21' => '4712087',
				'22' => '4712088',
				'23' => '4712089',
				'24' => '4712091',
				'25' => '4712092',
				'26' => '4712093',
				'27' => '4712094',
				'28' => '4712095',
				'29' => '4712096',
				'30' => '4712097',
				'31' => '4712098',
				'32' => '4712099',
				'33' => '4712100',
				'34' => '4712101',
				'35' => '4712102',
				'36' => '4712103',
				'37' => '4712104',
				'38' => '4712105',
				'39' => '4712107',
				'40' => '4712111',
				'41' => '4712112',
				'42' => '4712108',
				'43' => '4712109',
				'44' => '4712110',
				'45' => '4712159',
				'46' => '4712158',
				'47' => '4712160',
				'-3105' => '4712158',
			),
			'behavior' => 'superset'
		),
		'illness_2_us' => array(
			'lucid' => '760',
			'cint' => '275086',
			'precodes' => array(
				'1' => '4712113',
				'2' => '4712114',
				'3' => '4712115',
				'4' => '4712117',
				'5' => '4712118',
				'6' => '4712119',
				'7' => '4712120',
				'8' => '4712121',
				'9' => '4712122',
				'10' => '4712123',
				'11' => '4712124',
				'12' => '4712125',
				'13' => '4712126',
				'14' => '4712127',
				'15' => '4712128',
				'16' => '4712129',
				'17' => '4712130',
				'18' => '4712131',
				'19' => '4712133',
				'20' => '4712134',
				'21' => '4712135',
				'22' => '4712136',
				'23' => '4712137',
				'24' => '4712138',
				'25' => '4712139',
				'26' => '4712141',
				'27' => '4712142',
				'28' => '4712143',
				'29' => '4712144',
				'30' => '4712145',
				'31' => '4712146',
				'32' => '4712147',
				'33' => '4712148',
				'34' => '4712149',
				'35' => '4712150',
				'36' => '4712151',
				'37' => '4712152',
				'38' => '4712153',
				'39' => '4712154',
				'40' => '4712155',
				'41' => '4712156',
				'42' => '4712157',
				'43' => '4712159',
				'44' => '4712158',
				'45' => '4712160',
				'-3105' => '4712158',
			),
			'behavior' => 'superset'
		),
		'illness_2_ca' => array(
			'lucid' => '760',
			'cint' => '369579',
			'precodes' => array(
				'1' => '8268141',
				'2' => '8268181',
				'3' => '8268182',
				'4' => '8268121',
				'5' => '8268183',
				'6' => '8268184',
				'7' => '8268185',
				'8' => '8268186',
				'9' => '8268187',
				'10' => '8268188',
				'11' => '8268189',
				'12' => '8268112',
				'13' => '8268190',
				'14' => '8268191',
				'15' => '8268192',
				'16' => '8268123',
				'17' => '8268193',
				'18' => '8268194',
				'19' => '8268125',
				'20' => '8268195',
				'21' => '8268196',
				'22' => '8272831',
				'23' => '8268197',
				'24' => '8268198',
				'25' => '8268199',
				'26' => '8268200',
				'27' => '8268201',
				'28' => '8268202',
				'29' => '8268203',
				'30' => '8268204',
				'31' => '8268155',
				'32' => '8268156',
				'33' => '8268142',
				'34' => '8268139',
				'35' => '8268124',
				'36' => '8268131',
				'37' => '8268136',
				'38' => '8268138',
				'39' => '8268126',
				'40' => '8268128',
				'41' => '8268140',
				'42' => '8268137',
				'43' => '8268153',
				'44' => '8268152',
				'45' => '8268205',
				'-3105' => '8268152',
			),
			'behavior' => 'superset'
		),
		'department_us' => array(
			'lucid' => '646',
			'cint' => '275015',
			'precodes' => array(
				'1' => '4709694',
				'2' => '4709706',
				'3' => '4709713',
				'4' => '4709697',
				'5' => '4709696',
				'6' => '4709703',
				'7' => '4709699',
				'8' => '4709711',
				'9' => '4709712',
				'10' => '4709708',
				'11' => '4709709',
				'12' => '4709710',
				'13' => '4709700',
				'14' => '4709702',
				'15' => '4709714',
			),
			'behavior' => 'superset'
		),
		'department_ca' => array(
			'lucid' => '646',
			'cint' => '369506',
			'precodes' => array(
				'1' => '8265651',
				'2' => '8265663',
				'3' => '8265670',
				'4' => '8265654',
				'5' => '8265653',
				'6' => '8265660',
				'7' => '8265656',
				'8' => '8265668',
				'9' => '8265669',
				'10' => '8265665',
				'11' => '8265666',
				'12' => '8265667',
				'13' => '8265657',
				'14' => '8265659',
				'15' => '8265671',
			),
			'behavior' => 'superset'
		),
		'department_gb' => array(
			'lucid' => '646',
			'cint' => '369626',
			'precodes' => array(
				'1' => '8270087',
				'2' => '8270099',
				'3' => '8270106',
				'4' => '8270090',
				'5' => '8270089',
				'6' => '8270096',
				'7' => '8270092',
				'8' => '8270104',
				'9' => '8270105',
				'10' => '8270101',
				'11' => '8270102',
				'12' => '8270103',
				'13' => '8270093',
				'14' => '8270095',
				'15' => '8270107',
			),
			'behavior' => 'superset'
		),
		'electronics_us' => array(
			'lucid' => '733',
			'cint' => '275051',
			'precodes' => array(
				'1' => '4710895',
				'2' => '4710897',
				'3' => '4710917',
				'4' => '4710919',
				'5' => '4710898',
				'6' => '4710899',
				'7' => '4710900',
				'8' => '4710920',
				'9' => '4710901',
				'10' => '4710907',
				'11' => '4710902',
				'12' => '4710903',
				'13' => '4710904',
				'14' => '4710905',
				'15' => '4710906',
				'16' => '4710908',
				'17' => '4710909',
				'18' => '4710910',
				'19' => '4710911',
				'20' => '4710912',
				'21' => '4710913',
				'22' => '4710915',
				'23' => '4710916',
				'24' => '4710918',
				'25' => '4710914',
			),
			'behavior' => 'superset'
		),
		'electronics_ca' => array(
			'lucid' => '733',
			'cint' => '369541',
			'precodes' => array(
				'1' => '8266792',
				'2' => '8266794',
				'3' => '8266814',
				'4' => '8266816',
				'5' => '8266795',
				'6' => '8266796',
				'7' => '8266797',
				'8' => '8266817',
				'9' => '8266798',
				'10' => '8266804',
				'11' => '8266799',
				'12' => '8266800',
				'13' => '8266801',
				'14' => '8266802',
				'15' => '8266803',
				'16' => '8266805',
				'17' => '8266806',
				'18' => '8266807',
				'19' => '8266808',
				'20' => '8266809',
				'21' => '8266810',
				'22' => '8266812',
				'23' => '8266813',
				'24' => '8266815',
				'25' => '8266811',
			),
			'behavior' => 'superset'
		),
		'electronics_gb' => array(
			'lucid' => '733',
			'cint' => '369664',
			'precodes' => array(
				'1' => '8271388',
				'2' => '8271389',
				'3' => '8271409',
				'4' => '8271411',
				'5' => '8271390',
				'6' => '8271391',
				'7' => '8271392',
				'8' => '8271412',
				'9' => '8271393',
				'10' => '8271399',
				'11' => '8271394',
				'12' => '8271395',
				'13' => '8271396',
				'14' => '8271397',
				'15' => '8271398',
				'16' => '8271400',
				'17' => '8271401',
				'18' => '8271402',
				'19' => '8271403',
				'20' => '8271404',
				'21' => '8271405',
				'22' => '8271407',
				'23' => '8271408',
				'24' => '8271410',
				'25' => '8271406',
			),
			'behavior' => 'superset'
		),
		'decision_us' => array(
			'lucid' => '3546',
			'cint' => '275020',
			'precodes' => array(
				'1' => '4709793',
				'2' => '4709794',
				'3' => '4709795',
				'4' => '4709796',
				'5' => '4709797',
				'6' => '4709798',
				'7' => '4709801',
				'8' => '4709802',
				'9' => '4709804',
				'10' => '4709805',
				'11' => '4709806',
				'12' => '4709807',
				'13' => '4709809',
				'14' => '4709810',
				'15' => '4709812',
				'16' => '4709813',
				'17' => '4709814',
				'18' => '4709814',
			),
			'behavior' => 'superset'
		),
		'decision_ca' => array(
			'lucid' => '3546',
			'cint' => '369511',
			'precodes' => array(
				'1' => '8265750',
				'2' => '8265751',
				'3' => '8265752',
				'4' => '8265753',
				'5' => '8265754',
				'6' => '8265755',
				'7' => '8265758',
				'8' => '8265759',
				'9' => '8265761',
				'10' => '8265762',
				'11' => '8265763',
				'12' => '8265764',
				'13' => '8265766',
				'14' => '8265767',
				'15' => '8265769',
				'16' => '8265770',
				'17' => '8265771',
				'18' => '8265771',
			),
			'behavior' => 'superset'
		),
		'decision_gb' => array(
			'lucid' => '3546',
			'cint' => '369632',
			'precodes' => array(
				'1' => '8270198',
				'2' => '8270199',
				'3' => '8270200',
				'4' => '8270201',
				'5' => '8270202',
				'6' => '8270203',
				'7' => '8270206',
				'8' => '8270207',
				'9' => '8270209',
				'10' => '8270210',
				'11' => '8270211',
				'12' => '8270212',
				'13' => '8270214',
				'14' => '8270215',
				'15' => '8270217',
				'16' => '8270218',
				'17' => '8270219',
				'18' => '8270219',
			),
			'behavior' => 'superset'
		),
		'pets_us' => array(
			'lucid' => '639',
			'cint' => '275004',
			'precodes' => array(
				'1' => '4709445',
				'2' => '4709446',
				'3' => '4709450',
				'4' => '4709453',
				'5' => '4709448',
				'6' => '4709448',
				'7' => '4709451',
				'8' => '4709452',
				'9' => '4709449',
				'10' => '4709448',
				'-3105' => '4709448',
			),
			'behavior' => 'superset'
		),
		'pets_ca' => array(
			'lucid' => '639',
			'cint' => '369493',
			'precodes' => array(
				'1' => '8265030',
				'2' => '8265031',
				'3' => '8265035',
				'4' => '8265038',
				'5' => '8265033',
				'6' => '8265033',
				'7' => '8265036',
				'8' => '8265037',
				'9' => '8265034',
				'10' => '8265033',
				'-3105' => '8265033',
			),
			'behavior' => 'superset'
		),
		'pets_gb' => array(
			'lucid' => '639',
			'cint' => '369605',
			'precodes' => array(
				'1' => '8268425',
				'2' => '8268426',
				'3' => '8268430',
				'4' => '8268433',
				'5' => '8268428',
				'6' => '8268428',
				'7' => '8268431',
				'8' => '8268432',
				'9' => '8268429',
				'10' => '8268428',
				'-3105' => '8268428',
			),
			'behavior' => 'superset'
		),
		'have_car_us' => array(
			'lucid' => '647',
			'cint' => '275027',
			'precodes' => array(
				'1' => '4710171',
				'2' => '4710173',
				'3' => '4710172',
				'4' => '4710174',
			),
			'behavior' => 'superset'
		),
		'have_car_ca' => array(
			'lucid' => '647',
			'cint' => '369518',
			'precodes' => array(
				'1' => '8266151',
				'2' => '8266153',
				'3' => '8266152',
				'4' => '8266154',
			),
			'behavior' => 'superset'
		),
		'have_car_gb' => array(
			'lucid' => '647',
			'cint' => '369639',
			'precodes' => array(
				'1' => '8270599',
				'2' => '8270601',
				'3' => '8270600',
				'4' => '8270602',
			),
			'behavior' => 'superset'
		),
		'industry_us' => array(
			'lucid' => '643',
			'cint' => '275013',
			'precodes' => array(
				'1' => '4709656',
				'2' => '4709657',
				'3' => '4709634',
				'4' => '4709658',
				'5' => '4709659',
				'6' => '4709660',
				'7' => '4709636',
				'8' => '4709661',
				'9' => '4709662',
				'10' => '4709655',
				'11' => '4709663',
				'12' => '4709638',
				'13' => '4709664',
				'14' => '4709666',
				'15' => '4709665',
				'16' => '4709639',
				'17' => '4709667',
				'18' => '4709668',
				'19' => '4709669',
				'20' => '4709640',
				'21' => '4709670',
				'22' => '4709641',
				'23' => '4709671',
				'24' => '4709672',
				'25' => '4709655',
				'26' => '4709642',
				'27' => '4709643',
				'28' => '4709654',
				'29' => '4709673',
				'30' => '4709637',
				'31' => '4709674',
				'32' => '4709675',
				'33' => '4709644',
				'34' => '4709645',
				'35' => '4709676',
				'36' => '4709646',
				'37' => '4709647',
				'38' => '4709635',
				'39' => '4709650',
				'40' => '4709677',
				'41' => '4709648',
				'42' => '4709678',
				'43' => '4709679',
				'44' => '4709680',
				'45' => '4709649',
				'46' => '4709651',
				'47' => '4709681',
				'48' => '4709652',
				'49' => '4709653',
				'50' => '4709655',
				'51' => '4709683',
			),
			'behavior' => 'superset'
		),
		'industry_gb' => array(
			'lucid' => '643',
			'cint' => '369624',
			'precodes' => array(
				'1' => '8270049',
				'2' => '8270050',
				'3' => '8270027',
				'4' => '8270051',
				'5' => '8270052',
				'6' => '8270053',
				'7' => '8270029',
				'8' => '8270054',
				'9' => '8270055',
				'10' => '8270048',
				'11' => '8270056',
				'12' => '8270031',
				'13' => '8270057',
				'14' => '8270059',
				'15' => '8270058',
				'16' => '8270032',
				'17' => '8270060',
				'18' => '8270061',
				'19' => '8270062',
				'20' => '8270033',
				'21' => '8270063',
				'22' => '8270034',
				'23' => '8270064',
				'24' => '8270065',
				'25' => '8270048',
				'26' => '8270035',
				'27' => '8270036',
				'28' => '8270047',
				'29' => '8270066',
				'30' => '8270030',
				'31' => '8270067',
				'32' => '8270068',
				'33' => '8270037',
				'34' => '8270038',
				'35' => '8270069',
				'36' => '8270039',
				'37' => '8270040',
				'38' => '8270028',
				'39' => '8270043',
				'40' => '8270070',
				'41' => '8270041',
				'42' => '8270071',
				'43' => '8270072',
				'44' => '8270073',
				'45' => '8270042',
				'46' => '8270044',
				'47' => '8270074',
				'48' => '8270045',
				'49' => '8270046',
				'50' => '8270048',
				'51' => '8270076',
			),
			'behavior' => 'superset'
		),
		'industry_ca' => array(
			'lucid' => '643',
			'cint' => '369504',
			'precodes' => array(
				'1' => '8265613',
				'2' => '8265614',
				'3' => '8265591',
				'4' => '8265615',
				'5' => '8265616',
				'6' => '8265617',
				'7' => '8265593',
				'8' => '8265618',
				'9' => '8265619',
				'10' => '8265612',
				'11' => '8265620',
				'12' => '8265595',
				'13' => '8265621',
				'14' => '8265623',
				'15' => '8265622',
				'16' => '8265596',
				'17' => '8265624',
				'18' => '8265625',
				'19' => '8265626',
				'20' => '8265597',
				'21' => '8265627',
				'22' => '8265598',
				'23' => '8265628',
				'24' => '8265629',
				'25' => '8265612',
				'26' => '8265599',
				'27' => '8265600',
				'28' => '8265611',
				'29' => '8265630',
				'30' => '8265594',
				'31' => '8265631',
				'32' => '8265632',
				'33' => '8265601',
				'34' => '8265602',
				'35' => '8265633',
				'36' => '8265603',
				'37' => '8265604',
				'38' => '8265592',
				'39' => '8265607',
				'40' => '8265634',
				'41' => '8265605',
				'42' => '8265635',
				'43' => '8265636',
				'44' => '8265637',
				'45' => '8265606',
				'46' => '8265608',
				'47' => '8265638',
				'48' => '8265609',
				'49' => '8265610',
				'50' => '8265612',
				'51' => '8265640',
			),
			'behavior' => 'superset'
		),
		'industry_personal_us' => array(
			'lucid' => '5729',
			'cint' => '275013',
			'precodes' => array(
				'1' => '4709656',
				'2' => '4709657',
				'3' => '4709634',
				'4' => '4709658',
				'5' => '4709659',
				'6' => '4709660',
				'7' => '4709636',
				'8' => '4709661',
				'9' => '4709662',
				'10' => '4709655',
				'11' => '4709663',
				'12' => '4709638',
				'13' => '4709664',
				'14' => '4709666',
				'15' => '4709665',
				'16' => '4709639',
				'17' => '4709667',
				'18' => '4709668',
				'19' => '4709669',
				'20' => '4709640',
				'21' => '4709670',
				'22' => '4709641',
				'23' => '4709671',
				'24' => '4709672',
				'25' => '4709655',
				'26' => '4709642',
				'27' => '4709643',
				'28' => '4709654',
				'29' => '4709673',
				'30' => '4709637',
				'31' => '4709674',
				'32' => '4709675',
				'33' => '4709644',
				'34' => '4709645',
				'35' => '4709676',
				'36' => '4709646',
				'37' => '4709647',
				'38' => '4709635',
				'39' => '4709650',
				'40' => '4709677',
				'41' => '4709648',
				'42' => '4709678',
				'43' => '4709679',
				'44' => '4709680',
				'45' => '4709649',
				'46' => '4709651',
				'47' => '4709681',
				'48' => '4709652',
				'49' => '4709653',
				'50' => '4709655',
				'51' => '4709683',
			),
			'behavior' => 'superset'
		),
		'industry_personal_gb' => array(
			'lucid' => '5729',
			'cint' => '369624',
			'precodes' => array(
				'1' => '8270049',
				'2' => '8270050',
				'3' => '8270027',
				'4' => '8270051',
				'5' => '8270052',
				'6' => '8270053',
				'7' => '8270029',
				'8' => '8270054',
				'9' => '8270055',
				'10' => '8270048',
				'11' => '8270056',
				'12' => '8270031',
				'13' => '8270057',
				'14' => '8270059',
				'15' => '8270058',
				'16' => '8270032',
				'17' => '8270060',
				'18' => '8270061',
				'19' => '8270062',
				'20' => '8270033',
				'21' => '8270063',
				'22' => '8270034',
				'23' => '8270064',
				'24' => '8270065',
				'25' => '8270048',
				'26' => '8270035',
				'27' => '8270036',
				'28' => '8270047',
				'29' => '8270066',
				'30' => '8270030',
				'31' => '8270067',
				'32' => '8270068',
				'33' => '8270037',
				'34' => '8270038',
				'35' => '8270069',
				'36' => '8270039',
				'37' => '8270040',
				'38' => '8270028',
				'39' => '8270043',
				'40' => '8270070',
				'41' => '8270041',
				'42' => '8270071',
				'43' => '8270072',
				'44' => '8270073',
				'45' => '8270042',
				'46' => '8270044',
				'47' => '8270074',
				'48' => '8270045',
				'49' => '8270046',
				'50' => '8270048',
				'51' => '8270076',
			),
			'behavior' => 'superset'
		),
		'industry_personal_ca' => array(
			'lucid' => '5729',
			'cint' => '369504',
			'precodes' => array(
				'1' => '8265613',
				'2' => '8265614',
				'3' => '8265591',
				'4' => '8265615',
				'5' => '8265616',
				'6' => '8265617',
				'7' => '8265593',
				'8' => '8265618',
				'9' => '8265619',
				'10' => '8265612',
				'11' => '8265620',
				'12' => '8265595',
				'13' => '8265621',
				'14' => '8265623',
				'15' => '8265622',
				'16' => '8265596',
				'17' => '8265624',
				'18' => '8265625',
				'19' => '8265626',
				'20' => '8265597',
				'21' => '8265627',
				'22' => '8265598',
				'23' => '8265628',
				'24' => '8265629',
				'25' => '8265612',
				'26' => '8265599',
				'27' => '8265600',
				'28' => '8265611',
				'29' => '8265630',
				'30' => '8265594',
				'31' => '8265631',
				'32' => '8265632',
				'33' => '8265601',
				'34' => '8265602',
				'35' => '8265633',
				'36' => '8265603',
				'37' => '8265604',
				'38' => '8265592',
				'39' => '8265607',
				'40' => '8265634',
				'41' => '8265605',
				'42' => '8265635',
				'43' => '8265636',
				'44' => '8265637',
				'45' => '8265606',
				'46' => '8265608',
				'47' => '8265638',
				'48' => '8265609',
				'49' => '8265610',
				'50' => '8265612',
				'51' => '8265640',
			),
			'behavior' => 'superset'
		),
		'travel_purposes_us' => array(
			'lucid' => '750',
			'cint' => '275074',
			'precodes' => array(
				'1' => '4711445',
				'2' => '4711446',
				'3' => '4711447',
				'4' => '4711448',
			),
			'behavior' => 'superset'
		),
		'travel_purposes_gb' => array(
			'lucid' => '750',
			'cint' => '369689',
			'precodes' => array(
				'1' => '8271996',
				'2' => '8271997',
				'3' => '8271998',
				'4' => '8271999',
			),
			'behavior' => 'superset'
		),
		'travel_purposes_ca' => array(
			'lucid' => '750',
			'cint' => '369563',
			'precodes' => array(
				'1' => '8267357',
				'2' => '8267358',
				'3' => '8267359',
				'4' => '8267360',
			),
			'behavior' => 'superset'
		),
		'cancer_type_us' => array(
			'lucid' => '761',
			'cint' => '275087',
			'precodes' => array(
				'1' => '4712161',
				'2' => '4712169',
				'3' => '4712162',
				'4' => '4712163',
				'5' => '4712164',
				'6' => '4712165',
				'7' => '4712170',
				'8' => '4712168',
				'9' => '4712171',
				'10' => '4712166',
				'11' => '4712172',
				'12' => '4712167',
				'13' => '4712173',
				'14' => '4712175',
				'15' => '4712176',
				'16' => '4712174',
			),
			'behavior' => 'superset'
		),
		'cancer_type_gb' => array(
			'lucid' => '761',
			'cint' => '369703',
			'precodes' => array(
				'1' => '8272730',
				'2' => '8272738',
				'3' => '8272731',
				'4' => '8272732',
				'5' => '8272733',
				'6' => '8272734',
				'7' => '8272739',
				'8' => '8272737',
				'9' => '8272740',
				'10' => '8272735',
				'11' => '8272741',
				'12' => '8272736',
				'13' => '8272742',
				'14' => '8272744',
				'15' => '8272745',
				'16' => '8272743',
			),
			'behavior' => 'superset'
		),
		'cancer_type_ca' => array(
			'lucid' => '761',
			'cint' => '369576',
			'precodes' => array(
				'1' => '8268080',
				'2' => '8268088',
				'3' => '8268081',
				'4' => '8268082',
				'5' => '8268083',
				'6' => '8268084',
				'7' => '8268089',
				'8' => '8268087',
				'9' => '8268090',
				'10' => '8268085',
				'11' => '8268091',
				'12' => '8268086',
				'13' => '8268092',
				'14' => '8268094',
				'15' => '8268095',
				'16' => '8268093',
			),
			'behavior' => 'superset'
		),
		'flights_take_us' => array(
			'lucid' => '751',
			'cint' => '275075',
			'precodes' => array(
				'1' => '4711450',
				'2' => '4711451',
				'3' => '4711452',
				'4' => '4711453',
			),
			'behavior' => 'superset'
		),
		'flights_take_gb' => array(
			'lucid' => '751',
			'cint' => '369690',
			'precodes' => array(
				'1' => '8272001',
				'2' => '8272002',
				'3' => '8272003',
				'4' => '8272004',
			),
			'behavior' => 'superset'
		),
		'flights_take_ca' => array(
			'lucid' => '751',
			'cint' => '369564',
			'precodes' => array(
				'1' => '8267362',
				'2' => '8267363',
				'3' => '8267364',
				'4' => '8267365',
			),
			'behavior' => 'superset'
		),
		'financial_product_us' => array(
			'lucid' => '25640',
			'cint' => '275009',
			'precodes' => array(
				'1' => '4709556',
				'2' => '4709554',
				'3' => '4709559',
				'4' => '4709562',
				'5' => '4709561',
			),
			'behavior' => 'superset'
		),
		'vehicle_us' => array(
			'lucid' => '650',
			'cint' => '275030',
			'precodes' => array(
				'1' => '4710264',
				'2' => '4710251',
				'3' => '4710252',
				'4' => '4710253',
				'5' => '4710254',
				'6' => '4710255',
				'7' => '4710261',
				'8' => '4710256',
				'9' => '4710258',
				'10' => '4710257',
				'11' => '4710260',
				'12' => '4710259',
				'13' => '4710266',
				'14' => '4710262',
				'15' => '4710263',
			),
			'behavior' => 'superset'
		),
		'vehicle_gb' => array(
			'lucid' => '650',
			'cint' => '369642',
			'precodes' => array(
				'1' => '8270694',
				'2' => '8270692',
				'3' => '8270692',
				'4' => '8270692',
				'5' => '8270692',
				'6' => '8270685',
				'7' => '8270691',
				'8' => '8270686',
				'9' => '8270692',
				'10' => '8270687',
				'11' => '8270692',
				'12' => '8270692',
				'13' => '8270692',
				'14' => '8270692',
				'15' => '8270693',
			),
			'behavior' => 'superset'
		),
		'vehicle_ca' => array(
			'lucid' => '650',
			'cint' => '369521',
			'precodes' => array(
				'1' => '8266246',
				'2' => '8266233',
				'3' => '8266234',
				'4' => '8266235',
				'5' => '8266236',
				'6' => '8266237',
				'7' => '8266243',
				'8' => '8266238',
				'9' => '8266240',
				'10' => '8266239',
				'11' => '8266242',
				'12' => '8266241',
				'13' => '8266248',
				'14' => '8266244',
				'15' => '8266245',
			),
			'behavior' => 'superset'
		),
		'motorcycle_us' => array(
			'lucid' => '719',
			'cint' => '275035',
			'precodes' => array(
				'1' => '4710341',
				'2' => '4710342',
			),
			'behavior' => 'superset'
		),
		'motorcycle_gb' => array(
			'lucid' => '719',
			'cint' => '369648',
			'precodes' => array(
				'1' => '8270781',
				'2' => '8270782',
			),
			'behavior' => 'superset'
		),
		'motorcycle_ca' => array(
			'lucid' => '719',
			'cint' => '369526',
			'precodes' => array(
				'1' => '8266327',
				'2' => '8266328',
			),
			'behavior' => 'superset'
		),
		'diabetes_type_us' => array(
			'lucid' => '762',
			'cint' => '275088',
			'precodes' => array(
				'1' => '4712177',
				'2' => '4712178',
				'3' => '4712181',
				'4' => '4712180',
			),
			'behavior' => 'superset'
		),
		'diabetes_type_gb' => array(
			'lucid' => '762',
			'cint' => '369704',
			'precodes' => array(
				'1' => '8272746',
				'2' => '8272747',
				'3' => '8272750',
				'4' => '8272749',
			),
			'behavior' => 'superset'
		),
		'diabetes_type_ca' => array(
			'lucid' => '762',
			'cint' => '369577',
			'precodes' => array(
				'1' => '8268096',
				'2' => '8268097',
				'3' => '8268100',
				'4' => '8268099',
			),
			'behavior' => 'superset'
		),
	);

	function lucid_p2s() {
		if (!$this->loadSettings()) {
			return false;
		}
		
		$this->loadHttp();
		$total_questions = count($this->lucid_to_p2s); 
		$this->out('Starting '.$total_questions); 
		$i = 0; 
		foreach ($this->lucid_to_p2s as $item) {
			$i++;
			$this->out('Questions: '.$i.'/'.$total_questions);
			$reverse = false;
			if ($item['behavior'] == 'equivalent') {
				$reverse = true;
			}

			$total_answers = count($item['precodes']);
			$this->out('Answers: Total '.$total_answers);

			$j = 0;
			foreach ($item['precodes'] as $answer_from => $answer_to) {
				$j++;
				$this->out('Answers: '.$j.'/'.$total_answers);
				$this->qe_answers_map("lucid", "points2shop", $item['lucid'], $item['p2s'], $answer_from, $answer_to, $reverse);
			}
		}
	}

	function lucid_lucid() {
		if (!$this->loadSettings()) {
			return false;
		}
		
		$this->loadHttp();
		$total_questions = count($this->lucid_to_lucid); 
		$this->out('Starting '.$total_questions); 
		$i = 0; 
		foreach ($this->lucid_to_lucid as $item) {
			$i++;
			$this->out('Questions: '.$i.'/'.$total_questions);
			$reverse = false;
			if ($item['behavior'] == 'equivalent') {
				$reverse = true;
			}

			$total_answers = count($item['precodes']);
			$this->out('Answers: Total '.$total_answers);

			$j = 0;
			foreach ($item['precodes'] as $answer_from => $answer_to) {
				$j++;
				$this->out('Answers: '.$j.'/'.$total_answers);
				$this->qe_answers_map("lucid", "lucid", $item['v1'], $item['v2'], $answer_from, $answer_to, $reverse);
			}
		}
		$this->out('Completed');
	}
	
	function lucid_cint() {
		if (!$this->loadSettings()) {
			return false;
		}
		
		$this->loadHttp();
		$total_questions = count($this->lucid_to_cint); 
		$this->out('Starting '.$total_questions); 
		$i = 0; 
		foreach ($this->lucid_to_cint as $item) {
			$i++;
			$this->out('Questions: '.$i.'/'.$total_questions);
			$reverse = false;
			if ($item['behavior'] == 'equivalent') {
				$reverse = true;
			}
			
			$total_answers = count($item['precodes']); 
			$this->out('Answers: Total '.$total_answers); 
			
			$j = 0; 
			foreach ($item['precodes'] as $answer_from => $answer_to) {
				$j++; 
				$this->out('Answers: '.$j.'/'.$total_answers); 
				$this->qe_answers_map("lucid", "cint", $item['lucid'], $item['cint'], $answer_from, $answer_to, $reverse);
			}
		}
	}

	private function qe_answers_map($partner_from, $partner_to, $question_from, $question_to, $answer_from, $answer_to, $reverse = false) {
		$log_file = 'qe.map';
		$log_key = strtoupper($partner_from.'-'.$partner_to);
		
		if (defined('IS_DEV_INSTANCE') && IS_DEV_INSTANCE == true) {
			return;
		}
		
		try {
			$params = array(
				'from' => array(
					'partner' => $partner_from,
					'partner_question_id' => $question_from,
					'partner_answer_id' => $answer_from
				),
				'to' => array(
					'partner' => $partner_to,
					'partner_question_id' => $question_to,
					'partner_answer_id' => $answer_to
				),
				'reverse_map' => $reverse
			);
			$this->lecho(json_encode($params), $log_file, $log_key);

			$res = $this->Http->post($this->settings['hostname.qe'].'/answers/map', json_encode($params), array(
				'header' => array('Content-Type' => 'application/json')
			));
		}
		catch (Exception $ex) {
			$this->lecho('QE2 api call failed.', $log_file, $log_key);
			return false;
		}

		$this->lecho($res['body'], $log_file, $log_key);
	}

	private function loadSettings() {
		$log_file = 'qe.map';
		$keys = array(
			// QE2 API
			'qe.mintvine.username',
			'qe.mintvine.password',
			'hostname.qe'
		);
		$this->settings = $this->Setting->find('list', array(
			'fields' => array('name', 'value'),
			'conditions' => array(
				'Setting.name' => $keys,
				'Setting.deleted' => false
			)
		));
		if (count($this->settings) != count($keys)) {
			$diff_keys = array_diff($keys,  array_keys($this->settings));
			$this->lecho('FAILED: You are missing required settings: '.implode(', ', $diff_keys), $log_file);
			return false;
		}

		return true;
	}
	
	private function loadHttp() {
		App::uses('HttpSocket', 'Network/Http');
		$http = new HttpSocket(array(
			'timeout' => 120,
			'ssl_verify_host' => false // PHP does not seem to check SANs for CNs
		));
		$http->configAuth('Basic', $this->settings['qe.mintvine.username'], $this->settings['qe.mintvine.password']);
		$this->Http = $http;
	}
}
